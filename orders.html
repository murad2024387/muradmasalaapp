<!DOCTYPE html>
<html lang="sd" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>آرڊرز - مراد مسالا</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* General Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            color: #333;
        }
        
        /* Header Styles */
        header {
            background-color: #e67e22;
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
        }
        
        .logo {
            display: flex;
            align-items: center;
            font-size: 1.5rem;
            font-weight: bold;
        }
        
        .logo i {
            margin-left: 10px;
        }
        
        .menu-toggle {
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            display: none;
        }
        
        nav {
            display: flex;
        }
        
        .nav-category {
            display: flex;
        }
        
        .nav-btn {
            color: white;
            text-decoration: none;
            padding: 10px 15px;
            margin: 0 5px;
            border-radius: 5px;
            display: flex;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .nav-btn:hover {
            background-color: rgba(255,255,255,0.2);
        }
        
        .nav-btn i {
            margin-left: 8px;
        }
        
        .nav-btn.active {
            background-color: rgba(255,255,255,0.3);
        }
        
        .user-menu {
            position: relative;
        }
        
        .user-btn {
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        .user-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            background-color: white;
            min-width: 200px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-radius: 5px;
            display: none;
            z-index: 1001;
        }
        
        .user-dropdown a {
            display: block;
            padding: 10px 15px;
            color: #333;
            text-decoration: none;
            transition: background-color 0.3s;
        }
        
        .user-dropdown a:hover {
            background-color: #f5f5f5;
        }
        
        .user-dropdown a i {
            margin-left: 8px;
            width: 20px;
            text-align: center;
        }
        
        .dropdown-divider {
            height: 1px;
            background-color: #eee;
            margin: 5px 0;
        }
        
        /* Main Content */
        main {
            margin-top: 70px;
            padding: 20px;
        }
        
        /* Section Header */
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .section-header h2 {
            font-size: 1.5rem;
            color: #333;
            margin-bottom: 15px;
        }
        
        .section-header h2 i {
            margin-left: 10px;
            color: #e67e22;
        }
        
        .header-actions {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        /* Search Box */
        .search-box {
            background-color: white;
            border-radius: 5px;
            padding: 8px 15px;
            display: flex;
            align-items: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            width: 250px;
        }
        
        .search-box i {
            margin-left: 10px;
            color: #95a5a6;
        }
        
        .search-box input {
            border: none;
            outline: none;
            width: 100%;
            background: transparent;
        }
        
        /* Buttons */
        .btn {
            padding: 8px 15px;
            border-radius: 5px;
            border: none;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
        }
        
        .btn i {
            margin-left: 8px;
        }
        
        .btn-primary {
            background-color: #e67e22;
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #d35400;
        }
        
        .btn-success {
            background-color: #2ecc71;
            color: white;
        }
        
        .btn-success:hover {
            background-color: #27ae60;
        }
        
        .btn-danger {
            background-color: #e74c3c;
            color: white;
        }
        
        .btn-danger:hover {
            background-color: #c0392b;
        }
        
        .btn-outline {
            background-color: transparent;
            border: 1px solid #ddd;
            color: #333;
        }
        
        .btn-outline:hover {
            background-color: #f5f5f5;
        }
        
        .btn-sm {
            padding: 5px 10px;
            font-size: 0.85rem;
        }
        
        /* Tabs */
        .order-status-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            overflow-x: auto;
            padding-bottom: 5px;
        }
        
        .tab-btn {
            padding: 8px 15px;
            border-radius: 20px;
            border: none;
            background-color: #ecf0f1;
            color: #7f8c8d;
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.3s;
        }
        
        .tab-btn.active {
            background-color: #e67e22;
            color: white;
        }
        
        /* Order Cards Grid */
        .orders-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        /* Order Card */
        .order-card {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 15px;
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .order-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .order-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .order-header h3 {
            font-size: 1.1rem;
        }
        
        .badge {
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 500;
        }
        
        .badge.warning {
            background-color: #f39c12;
            color: white;
        }
        
        .badge.primary {
            background-color: #3498db;
            color: white;
        }
        
        .badge.success {
            background-color: #2ecc71;
            color: white;
        }
        
        .badge.danger {
            background-color: #e74c3c;
            color: white;
        }
        
        .order-details {
            margin-bottom: 15px;
        }
        
        .order-details p {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
            color: #555;
        }
        
        .order-details i {
            margin-left: 8px;
            width: 20px;
            color: #7f8c8d;
        }
        
        .order-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }
        
        /* Pagination */
        .pagination {
            display: flex;
            justify-content: center;
            gap: 5px;
        }
        
        /* Empty State */
        .empty-state {
            background-color: white;
            padding: 30px;
            text-align: center;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            color: #95a5a6;
            grid-column: 1 / -1;
        }
        
        .empty-state i {
            font-size: 2rem;
            margin-bottom: 10px;
            color: #bdc3c7;
        }
        
        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background-color: white;
            border-radius: 8px;
            width: 90%;
            max-width: 800px;
            padding: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            position: relative;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .close {
            position: absolute;
            top: 15px;
            left: 15px;
            font-size: 1.5rem;
            cursor: pointer;
            color: #95a5a6;
        }
        
        .modal h3 {
            margin-bottom: 20px;
            font-size: 1.3rem;
            color: #333;
        }
        
        .modal h3 i {
            margin-left: 10px;
            color: #e67e22;
        }
        
        /* Order Details */
        .order-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .order-info-item {
            margin-bottom: 10px;
        }
        
        .order-info-item strong {
            display: block;
            margin-bottom: 5px;
            color: #333;
        }
        
        /* Order Items Table */
        .order-items {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        
        .order-items th {
            background-color: #f8f9fa;
            padding: 10px;
            text-align: right;
            border-bottom: 1px solid #ddd;
        }
        
        .order-items td {
            padding: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .order-items tr:last-child td {
            border-bottom: none;
        }
        
        .order-summary {
            display: flex;
            justify-content: flex-end;
            margin-top: 20px;
        }
        
        .summary-table {
            width: 300px;
            border-collapse: collapse;
        }
        
        .summary-table td {
            padding: 8px;
            border-bottom: 1px solid #eee;
        }
        
        .summary-table tr:last-child td {
            border-bottom: none;
            font-weight: bold;
            font-size: 1.1rem;
        }
        
        /* Form Styles */
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #333;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
        }
        
        .form-actions {
            display: flex;
            justify-content: flex-end;
            margin-top: 20px;
            gap: 10px;
        }
        
        /* Responsive Styles */
        @media (max-width: 768px) {
            .menu-toggle {
                display: block;
            }
            
            nav {
                display: none;
                position: fixed;
                top: 70px;
                left: 0;
                width: 100%;
                background-color: #e67e22;
                padding: 10px 0;
                box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            }
            
            .nav-category {
                flex-direction: column;
                width: 100%;
            }
            
            .nav-btn {
                margin: 5px 0;
                justify-content: flex-end;
            }
            
            .section-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .header-actions {
                width: 100%;
                flex-direction: column;
                gap: 10px;
            }
            
            .search-box {
                width: 100%;
            }
            
            .order-info {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
<header>
  <div class="logo">
    <i class="fas fa-pepper-hot"></i>
    <span>مراد مسالا</span>
  </div>
  
  <button class="menu-toggle" onclick="toggleMenu()">
    <i class="fas fa-bars"></i>
  </button>
  
  <nav id="mainNav">
    <div class="nav-category">
      <a href="index.html" class="nav-btn">
        <i class="fas fa-home"></i>
        <span>ڊش بورڊ</span>
      </a>
      <a href="products.html" class="nav-btn">
        <i class="fas fa-boxes"></i>
        <span>پراڊڪٽس</span>
      </a>
      <a href="categories.html" class="nav-btn">
        <i class="fas fa-tags"></i>
        <span>ڪيٽيگري</span>
      </a>
      <a href="orders.html" class="nav-btn active">
        <i class="fas fa-shopping-cart"></i>
        <span>آرڊرز</span>
      </a>
      <a href="customers.html" class="nav-btn">
        <i class="fas fa-users"></i>
        <span>گاھڪ</span>
      </a>
    </div>
  </nav>
  
  <div class="user-menu">
    <button class="user-btn" onclick="toggleUserMenu()">
      <i class="fas fa-user-circle"></i>
    </button>
    <div class="user-dropdown" id="userDropdown">
      <a href="profile.html"><i class="fas fa-user"></i> پروفائل</a>
      <a href="settings.html"><i class="fas fa-cog"></i> سيٽنگز</a>
      <div class="dropdown-divider"></div>
      <a href="#" onclick="logout()"><i class="fas fa-sign-out-alt"></i> لاگ آؤٽ</a>
    </div>
  </div>
</header>
    <main>
        <section class="content-section">
            <div class="section-header">
                <h2><i class="fas fa-clipboard-check"></i> آرڊرز</h2>
                <div class="header-actions">
                    <div class="search-box">
                        <input type="text" id="orderSearch" placeholder="آرڊر ڳوليو...">
                        <i class="fas fa-search"></i>
                    </div>
                    <button class="btn btn-primary" id="addOrderBtn">
                        <i class="fas fa-plus"></i> نئون آرڊر
                    </button>
                </div>
            </div>
            
            <div class="order-status-tabs">
                <button class="tab-btn active" data-status="all">سڀ (<span id="allCount">0</span>)</button>
                <button class="tab-btn" data-status="pending">زير التواء (<span id="pendingCount">0</span>)</button>
                <button class="tab-btn" data-status="processing">تيار ٿي رهيو آهي (<span id="processingCount">0</span>)</button>
                <button class="tab-btn" data-status="completed">ڊليور ٿيل (<span id="completedCount">0</span>)</button>
                <button class="tab-btn" data-status="cancelled">منسوخ (<span id="cancelledCount">0</span>)</button>
            </div>
            
            <div id="ordersList">
                <!-- Orders will be loaded here via JavaScript -->
                <div class="loader">لوڊ ڪري رهيو آهي...</div>
            </div>
            
            <div class="pagination" id="pagination">
                <button class="btn btn-outline" id="prevPage" disabled><i class="fas fa-chevron-right"></i></button>
                <div id="pageNumbers"></div>
                <button class="btn btn-outline" id="nextPage"><i class="fas fa-chevron-left"></i></button>
            </div>
        </section>
    </main>

    <!-- Order Details Modal -->
    <div class="modal" id="orderDetailsModal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <h3><i class="fas fa-file-invoice"></i> آرڊر جي تفصيل</h3>
            
            <div class="order-info">
                <div>
                    <div class="order-info-item">
                        <strong>آرڊر نمبر:</strong>
                        <span id="detailOrderId">ORD-1001</span>
                    </div>
                    <div class="order-info-item">
                        <strong>تاريخ:</strong>
                        <span id="detailOrderDate">24/03/2023</span>
                    </div>
                    <div class="order-info-item">
                        <strong>حالت:</strong>
                        <span id="detailOrderStatus" class="badge warning">زير التواء</span>
                    </div>
                </div>
                <div>
                    <div class="order-info-item">
                        <strong>گاھڪ جو نالو:</strong>
                        <span id="detailCustomerName">علي احمد</span>
                    </div>
                    <div class="order-info-item">
                        <strong>فون نمبر:</strong>
                        <span id="detailCustomerPhone">03001234567</span>
                    </div>
                    <div class="order-info-item">
                        <strong>پتو:</strong>
                        <span id="detailCustomerAddress">گلشن اقبال، ڪراچي</span>
                    </div>
                </div>
            </div>
            
            <h4><i class="fas fa-list"></i> آرڊر آئيٽم</h4>
            <table class="order-items">
                <thead>
                    <tr>
                        <th>پراڊڪٽ</th>
                        <th>قيمت</th>
                        <th>مقدار</th>
                        <th>ڪل</th>
                    </tr>
                </thead>
                <tbody id="orderItemsList">
                    <!-- Order items will be loaded here -->
                </tbody>
            </table>
            
            <div class="order-summary">
                <table class="summary-table">
                    <tr>
                        <td>سب ٽوٽل:</td>
                        <td id="subtotal">₹1,200.00</td>
                    </tr>
                    <tr>
                        <td>ڊليوري فِي:</td>
                        <td id="deliveryFee">₹50.00</td>
                    </tr>
                    <tr>
                        <td>ڪل:</td>
                        <td id="totalAmount">₹1,250.00</td>
                    </tr>
                </table>
            </div>
            
            <div class="form-actions">
                <button class="btn btn-outline" onclick="closeModal()">بند ڪريو</button>
                <button class="btn btn-primary" id="printOrderBtn"><i class="fas fa-print"></i> پرنٽ ڪريو</button>
            </div>
        </div>
    </div>
    
    <!-- New Order Modal -->
    <div class="modal" id="newOrderModal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <h3><i class="fas fa-plus"></i> نئون آرڊر</h3>
            
            <form id="orderForm">
                <div class="order-info">
                    <div>
                        <div class="form-group">
                            <label for="customerName">گاھڪ جو نالو*</label>
                            <input type="text" id="customerName" required>
                        </div>
                        <div class="form-group">
                            <label for="customerPhone">فون نمبر*</label>
                            <input type="tel" id="customerPhone" required>
                        </div>
                    </div>
                    <div>
                        <div class="form-group">
                            <label for="orderStatus">حالت*</label>
                            <select id="orderStatus" required>
                                <option value="pending">زير التواء</option>
                                <option value="processing">تيار ٿي رهيو آهي</option>
                                <option value="completed">ڊليور ٿيل</option>
                                <option value="cancelled">منسوخ</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="deliveryFee">ڊليوري فِي</label>
                            <input type="number" id="deliveryFee" value="50">
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="customerAddress">پتو</label>
                    <textarea id="customerAddress" rows="3"></textarea>
                </div>
                
                <h4><i class="fas fa-list"></i> پراڊڪٽ شامل ڪريو</h4>
                <div id="orderProductsList">
                    <!-- Products will be added here -->
                    <div class="empty-state">
                        <i class="fas fa-box-open"></i>
                        <p>ڪوبه پراڊڪٽ شامل نه ڪيو ويو آهي</p>
                        <button type="button" class="btn btn-primary" id="addProductBtn">
                            <i class="fas fa-plus"></i> پراڊڪٽ شامل ڪريو
                        </button>
                    </div>
                </div>
                
                <div class="order-summary">
                    <table class="summary-table">
                        <tr>
                            <td>سب ٽوٽل:</td>
                            <td id="newSubtotal">₹0.00</td>
                        </tr>
                        <tr>
                            <td>ڊليوري فِي:</td>
                            <td id="newDeliveryFee">₹50.00</td>
                        </tr>
                        <tr>
                            <td>ڪل:</td>
                            <td id="newTotalAmount">₹50.00</td>
                        </tr>
                    </table>
                </div>
                
                <div class="form-actions">
                    <button type="button" class="btn btn-outline" onclick="closeModal()">منسوخ ڪريو</button>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i> آرڊر محفوظ ڪريو
                    </button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Add Product Modal -->
    <div class="modal" id="addProductModal">
        <div class="modal-content small">
            <span class="close" onclick="closeModal()">&times;</span>
            <h3><i class="fas fa-plus"></i> پراڊڪٽ شامل ڪريو</h3>
            
            <div class="form-group">
                <label for="productSearch">پراڊڪٽ ڳوليو</label>
                <div class="search-box">
                    <input type="text" id="productSearch" placeholder="پراڊڪٽ جو نالو...">
                    <i class="fas fa-search"></i>
                </div>
            </div>
            
            <div id="productsList" style="max-height: 300px; overflow-y: auto;">
                <!-- Products will be loaded here -->
            </div>
        </div>
    </div>
    
    <!-- Confirm Action Modal -->
    <div class="modal" id="confirmModal">
        <div class="modal-content small">
            <h3><i class="fas fa-exclamation-triangle"></i> <span id="confirmTitle">عمل جي تصديق</span></h3>
            <p id="confirmMessage">ڇا توهان پڪ آهيو ته توهان هي عمل ڪرڻ چاهيو ٿا؟</p>
            <div class="modal-actions">
                <button class="btn btn-danger" id="confirmActionBtn">هاڻ</button>
                <button class="btn btn-outline" onclick="closeModal()">منسوخ ڪريو</button>
            </div>
        </div>
    </div>

    <script>
        // Order Management System
        document.addEventListener('DOMContentLoaded', function() {
            // Local Storage Functions
            function getOrders() {
                const orders = localStorage.getItem('muradMasalaOrders');
                return orders ? JSON.parse(orders) : [];
            }
            
            function saveOrders(orders) {
                localStorage.setItem('muradMasalaOrders', JSON.stringify(orders));
            }
            
            function getProducts() {
                const products = localStorage.getItem('muradMasalaProducts');
                return products ? JSON.parse(products) : [];
            }
            
            function getCustomers() {
                const customers = localStorage.getItem('muradMasalaCustomers');
                return customers ? JSON.parse(customers) : [];
            }
            
            // Format date
            function formatDate(dateString) {
                const date = new Date(dateString);
                return date.toLocaleDateString('en-GB');
            }
            
            // Format currency
            function formatCurrency(amount) {
                return '₹' + amount.toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,');
            }
            
            // Load Orders
            function loadOrders(status = 'all', page = 1, searchTerm = '') {
                let orders = getOrders();
                
                // Filter by status
                if (status !== 'all') {
                    orders = orders.filter(order => order.status === status);
                }
                
                // Filter by search term
                if (searchTerm) {
                    const term = searchTerm.toLowerCase();
                    orders = orders.filter(order => 
                        order.id.toLowerCase().includes(term) || 
                        order.customer.name.toLowerCase().includes(term) ||
                        order.customer.phone.toLowerCase().includes(term)
                    );
                }
                
                // Update counts
                const allOrders = getOrders();
                document.getElementById('allCount').textContent = allOrders.length;
                document.getElementById('pendingCount').textContent = allOrders.filter(o => o.status === 'pending').length;
                document.getElementById('processingCount').textContent = allOrders.filter(o => o.status === 'processing').length;
                document.getElementById('completedCount').textContent = allOrders.filter(o => o.status === 'completed').length;
                document.getElementById('cancelledCount').textContent = allOrders.filter(o => o.status === 'cancelled').length;
                
                // Pagination
                const perPage = 8;
                const totalPages = Math.ceil(orders.length / perPage);
                const startIndex = (page - 1) * perPage;
                const paginatedOrders = orders.slice(startIndex, startIndex + perPage);
                
                // Update pagination controls
                updatePaginationControls(page, totalPages);
                
                // Display orders
                const ordersList = document.getElementById('ordersList');
                
                if (paginatedOrders.length === 0) {
                    ordersList.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-shopping-cart"></i>
                            <p>ڪوبه آرڊر مليو نه ڪيو</p>
                        </div>
                    `;
                    return;
                }
                
                let html = '';
                paginatedOrders.forEach(order => {
                    const statusBadge = {
                        'pending': 'warning',
                        'processing': 'primary',
                        'completed': 'success',
                        'cancelled': 'danger'
                    }[order.status];
                    
                    const statusText = {
                        'pending': 'زير التواء',
                        'processing': 'تيار ٿي رهيو آهي',
                        'completed': 'ڊليور ٿيل',
                        'cancelled': 'منسوخ'
                    }[order.status];
                    
                    const subtotal = order.items.reduce((sum, item) => sum + (item.price * item.quantity), 0);
                    const total = subtotal + (order.deliveryFee || 0);
                    
                    html += `
                        <div class="order-card" data-id="${order.id}">
                            <div class="order-header">
                                <h3>آرڊر #${order.id}</h3>
                                <span class="badge ${statusBadge}">${statusText}</span>
                            </div>
                            <div class="order-details">
                                <p><i class="fas fa-user"></i> ${order.customer.name}</p>
                                <p><i class="fas fa-calendar"></i> ${formatDate(order.date)}</p>
                                <p><i class="fas fa-rupee-sign"></i> ${formatCurrency(total)}</p>
                            </div>
                            <div class="order-actions">
                                <button class="btn btn-sm btn-outline" onclick="viewOrderDetails('${order.id}')">ڏسو</button>
                                ${order.status === 'pending' ? 
                                    `<button class="btn btn-sm btn-primary" onclick="updateOrderStatus('${order.id}', 'processing')">پروسيس ڪريو</button>` : 
                                    order.status === 'processing' ? 
                                    `<button class="btn btn-sm btn-success" onclick="updateOrderStatus('${order.id}', 'completed')">ڊليور ڪريو</button>` : 
                                    ''}
                                ${order.status !== 'cancelled' && order.status !== 'completed' ? 
                                    `<button class="btn btn-sm btn-danger" onclick="cancelOrder('${order.id}')">منسوخ ڪريو</button>` : 
                                    ''}
                            </div>
                        </div>
                    `;
                });
                
                ordersList.innerHTML = html;
            }
            
            // Update pagination controls
            function updatePaginationControls(currentPage, totalPages) {
                const pageNumbers = document.getElementById('pageNumbers');
                const prevBtn = document.getElementById('prevPage');
                const nextBtn = document.getElementById('nextPage');
                
                // Clear existing page numbers
                pageNumbers.innerHTML = '';
                
                // Update prev/next buttons
                prevBtn.disabled = currentPage === 1;
                nextBtn.disabled = currentPage === totalPages || totalPages === 0;
                
                // Add page numbers
                for (let i = 1; i <= totalPages; i++) {
                    const pageBtn = document.createElement('button');
                    pageBtn.className = `btn btn-outline ${i === currentPage ? 'active' : ''}`;
                    pageBtn.textContent = i;
                    pageBtn.onclick = () => {
                        const activeTab = document.querySelector('.order-status-tabs .tab-btn.active');
                        const status = activeTab.dataset.status;
                        const searchTerm = document.getElementById('orderSearch').value;
                        loadOrders(status, i, searchTerm);
                    };
                    pageNumbers.appendChild(pageBtn);
                }
            }
            
            // View Order Details
            window.viewOrderDetails = function(orderId) {
                const orders = getOrders();
                const order = orders.find(o => o.id === orderId);
                
                if (order) {
                    document.getElementById('detailOrderId').textContent = order.id;
                    document.getElementById('detailOrderDate').textContent = formatDate(order.date);
                    document.getElementById('detailCustomerName').textContent = order.customer.name;
                    document.getElementById('detailCustomerPhone').textContent = order.customer.phone;
                    document.getElementById('detailCustomerAddress').textContent = order.customer.address || '—';
                    
                    // Set status badge
                    const statusBadge = document.getElementById('detailOrderStatus');
                    statusBadge.className = 'badge ' + {
                        'pending': 'warning',
                        'processing': 'primary',
                        'completed': 'success',
                        'cancelled': 'danger'
                    }[order.status];
                    statusBadge.textContent = {
                        'pending': 'زير التواء',
                        'processing': 'تيار ٿي رهيو آهي',
                        'completed': 'ڊليور ٿيل',
                        'cancelled': 'منسوخ'
                    }[order.status];
                    
                    // Load order items
                    const itemsList = document.getElementById('orderItemsList');
                    itemsList.innerHTML = '';
                    
                    order.items.forEach(item => {
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${item.name}</td>
                            <td>${formatCurrency(item.price)}</td>
                            <td>${item.quantity}</td>
                            <td>${formatCurrency(item.price * item.quantity)}</td>
                        `;
                        itemsList.appendChild(row);
                    });
                    
                    // Calculate totals
                    const subtotal = order.items.reduce((sum, item) => sum + (item.price * item.quantity), 0);
                    const total = subtotal + (order.deliveryFee || 0);
                    
                    document.getElementById('subtotal').textContent = formatCurrency(subtotal);
                    document.getElementById('deliveryFee').textContent = formatCurrency(order.deliveryFee || 0);
                    document.getElementById('totalAmount').textContent = formatCurrency(total);
                    
                    // Open modal
                    openModal('orderDetailsModal');
                }
            };
            
            // Update Order Status
            window.updateOrderStatus = function(orderId, newStatus) {
                const orders = getOrders();
                const orderIndex = orders.findIndex(o => o.id === orderId);
                
                if (orderIndex !== -1) {
                    orders[orderIndex].status = newStatus;
                    saveOrders(orders);
                    
                    // Reload orders
                    const activeTab = document.querySelector('.order-status-tabs .tab-btn.active');
                    const status = activeTab.dataset.status;
                    const searchTerm = document.getElementById('orderSearch').value;
                    loadOrders(status, 1, searchTerm);
                    
                    alert('آرڊر جي حالت ڪاميابي سان تبديل ڪئي وئي آهي');
                }
            };
            
            // Cancel Order
            window.cancelOrder = function(orderId) {
                showConfirmModal(
                    'آرڊر منسوخ ڪريو',
                    'ڇا توهان پڪ آهيو ته توهان هن آرڊر کي منسوخ ڪرڻ چاهيو ٿا؟',
                    () => {
                        updateOrderStatus(orderId, 'cancelled');
                        closeModal();
                    }
                );
            };
            
            // Show Confirm Modal
            window.showConfirmModal = function(title, message, confirmAction) {
                document.getElementById('confirmTitle').textContent = title;
                document.getElementById('confirmMessage').textContent = message;
                
                const confirmBtn = document.getElementById('confirmActionBtn');
                confirmBtn.onclick = confirmAction;
                
                openModal('confirmModal');
            };
            
            // Add New Order
            document.getElementById('addOrderBtn').addEventListener('click', function() {
                document.getElementById('orderForm').reset();
                document.getElementById('orderStatus').value = 'pending';
                document.getElementById('deliveryFee').value = '50';
                document.getElementById('orderProductsList').innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-box-open"></i>
                        <p>ڪوبه پراڊڪٽ شامل نه ڪيو ويو آهي</p>
                        <button type="button" class="btn btn-primary" id="addProductBtn">
                            <i class="fas fa-plus"></i> پراڊڪٽ شامل ڪريو
                        </button>
                    </div>
                `;
                document.getElementById('newSubtotal').textContent = '₹0.00';
                document.getElementById('newDeliveryFee').textContent = '₹50.00';
                document.getElementById('newTotalAmount').textContent = '₹50.00';
                
                document.getElementById('addProductBtn').addEventListener('click', openAddProductModal);
                openModal('newOrderModal');
            });
            
            // Open Add Product Modal
            function openAddProductModal() {
                const products = getProducts();
                const productsList = document.getElementById('productsList');
                productsList.innerHTML = '';
                
                if (products.length === 0) {
                    productsList.innerHTML = '<p>ڪوبه پراڊڪٽ موجود نه آهي</p>';
                    return;
                }
                
                products.forEach(product => {
                    const productItem = document.createElement('div');
                    productItem.className = 'product-item';
                    productItem.style.padding = '10px';
                    productItem.style.borderBottom = '1px solid #eee';
                    productItem.style.cursor = 'pointer';
                    productItem.style.display = 'flex';
                    productItem.style.justifyContent = 'space-between';
                    productItem.style.alignItems = 'center';
                    productItem.innerHTML = `
                        <div>
                            <strong>${product.name}</strong>
                            <div>${formatCurrency(product.price)} / ${product.unit}</div>
                        </div>
                        <button class="btn btn-sm btn-primary" onclick="addProductToOrder('${product.id}')">
                            <i class="fas fa-plus"></i> شامل ڪريو
                        </button>
                    `;
                    productsList.appendChild(productItem);
                });
                
                openModal('addProductModal');
            }
            
            // Add Product to Order
            window.addProductToOrder = function(productId) {
                const products = getProducts();
                const product = products.find(p => p.id === productId);
                
                if (product) {
                    // Check if product already exists in order
                    const existingProduct = document.querySelector(`.order-product[data-id="${product.id}"]`);
                    
                    if (existingProduct) {
                        const quantityInput = existingProduct.querySelector('.product-quantity');
                        quantityInput.value = parseInt(quantityInput.value) + 1;
                        updateProductTotal(existingProduct);
                    } else {
                        // Add new product to order
                        const productsList = document.getElementById('orderProductsList');
                        
                        // Remove empty state if present
                        if (productsList.querySelector('.empty-state')) {
                            productsList.innerHTML = '';
                        }
                        
                        const productItem = document.createElement('div');
                        productItem.className = 'order-product';
                        productItem.dataset.id = product.id;
                        productItem.style.display = 'flex';
                        productItem.style.justifyContent = 'space-between';
                        productItem.style.alignItems = 'center';
                        productItem.style.marginBottom = '10px';
                        productItem.style.padding = '10px';
                        productItem.style.backgroundColor = '#f9f9f9';
                        productItem.style.borderRadius = '5px';
                        productItem.innerHTML = `
                            <div style="flex: 1;">
                                <strong>${product.name}</strong>
                                <div>${formatCurrency(product.price)} / ${product.unit}</div>
                            </div>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <input type="number" class="product-quantity" value="1" min="1" style="width: 60px; padding: 5px;" onchange="updateProductTotal(this.parentNode.parentNode)">
                                <span class="product-total" style="width: 80px; text-align: right;">${formatCurrency(product.price)}</span>
                                <button class="btn btn-sm btn-danger" onclick="removeProductFromOrder(this.parentNode.parentNode)">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        `;
                        productsList.appendChild(productItem);
                    }
                    
                    updateOrderTotals();
                    closeModal();
                }
            };
            
            // Update Product Total
            window.updateProductTotal = function(productElement) {
                const quantity = productElement.querySelector('.product-quantity').value;
                const price = parseFloat(productElement.querySelector('div div').textContent.replace(/[^0-9.]/g, ''));
                const total = quantity * price;
                productElement.querySelector('.product-total').textContent = formatCurrency(total);
                updateOrderTotals();
            };
            
            // Remove Product from Order
            window.removeProductFromOrder = function(productElement) {
                productElement.remove();
                const productsList = document.getElementById('orderProductsList');
                if (productsList.children.length === 0) {
                    productsList.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-box-open"></i>
                            <p>ڪوبه پراڊڪٽ شامل نه ڪيو ويو آهي</p>
                            <button type="button" class="btn btn-primary" id="addProductBtn">
                                <i class="fas fa-plus"></i> پراڊڪٽ شامل ڪريو
                            </button>
                        </div>
                    `;
                    document.getElementById('addProductBtn').addEventListener('click', openAddProductModal);
                }
                updateOrderTotals();
            };
            
            // Update Order Totals
            function updateOrderTotals() {
                const productElements = document.querySelectorAll('.order-product');
                let subtotal = 0;
                
                productElements.forEach(product => {
                    const totalText = product.querySelector('.product-total').textContent;
                    subtotal += parseFloat(totalText.replace(/[^0-9.]/g, ''));
                });
                
                const deliveryFee = parseFloat(document.getElementById('deliveryFee').value) || 0;
                const total = subtotal + deliveryFee;
                
                document.getElementById('newSubtotal').textContent = formatCurrency(subtotal);
                document.getElementById('newDeliveryFee').textContent = formatCurrency(deliveryFee);
                document.getElementById('newTotalAmount').textContent = formatCurrency(total);
            }
            
            // Save New Order
            document.getElementById('orderForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const customerName = document.getElementById('customerName').value.trim();
                const customerPhone = document.getElementById('customerPhone').value.trim();
                const orderStatus = document.getElementById('orderStatus').value;
                const deliveryFee = parseFloat(document.getElementById('deliveryFee').value) || 0;
                const customerAddress = document.getElementById('customerAddress').value.trim();
                
                if (!customerName || !customerPhone) {
                    alert('مهرباني ڪري گاھڪ جو نالو ۽ فون نمبر داخل ڪريو');
                    return;
                }
                
                const productElements = document.querySelectorAll('.order-product');
                if (productElements.length === 0) {
                    alert('مهرباني ڪري گھٽ ۾ گھٽ هڪ پراڊڪٽ شامل ڪريو');
                    return;
                }
                
                const products = getProducts();
                const orderItems = [];
                
                productElements.forEach(product => {
                    const productId = product.dataset.id;
                    const productDetails = products.find(p => p.id === productId);
                    const quantity = parseInt(product.querySelector('.product-quantity').value);
                    
                    if (productDetails) {
                        orderItems.push({
                            id: productId,
                            name: productDetails.name,
                            price: productDetails.price,
                            quantity: quantity,
                            unit: productDetails.unit
                        });
                    }
                });
                
                const subtotal = orderItems.reduce((sum, item) => sum + (item.price * item.quantity), 0);
                const total = subtotal + deliveryFee;
                
                // Create new order
                const orders = getOrders();
                const newOrder = {
                    id: 'ORD-' + (1000 + orders.length + 1),
                    date: new Date().toISOString(),
                    status: orderStatus,
                    customer: {
                        name: customerName,
                        phone: customerPhone,
                        address: customerAddress
                    },
                    items: orderItems,
                    deliveryFee: deliveryFee,
                    subtotal: subtotal,
                    total: total
                };
                
                orders.push(newOrder);
                saveOrders(orders);
                
                // Reload orders
                const activeTab = document.querySelector('.order-status-tabs .tab-btn.active');
                const status = activeTab.dataset.status;
                const searchTerm = document.getElementById('orderSearch').value;
                loadOrders(status, 1, searchTerm);
                
                closeModal();
                alert('آرڊر ڪاميابي سان محفوظ ڪيو ويو آهي');
            });
            
            // Tab Switching
            document.querySelectorAll('.order-status-tabs .tab-btn').forEach(tab => {
                tab.addEventListener('click', function() {
                    document.querySelectorAll('.order-status-tabs .tab-btn').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    const status = this.dataset.status;
                    const searchTerm = document.getElementById('orderSearch').value;
                    loadOrders(status, 1, searchTerm);
                });
            });
            
            // Search Functionality
            document.getElementById('orderSearch').addEventListener('input', function() {
                const searchTerm = this.value;
                const activeTab = document.querySelector('.order-status-tabs .tab-btn.active');
                const status = activeTab.dataset.status;
                loadOrders(status, 1, searchTerm);
            });
            
            // Pagination Controls
            document.getElementById('prevPage').addEventListener('click', function() {
                const activeTab = document.querySelector('.order-status-tabs .tab-btn.active');
                const status = activeTab.dataset.status;
                const searchTerm = document.getElementById('orderSearch').value;
                const currentPage = parseInt(document.querySelector('.pagination .btn-outline.active')?.textContent || 1);
                loadOrders(status, currentPage - 1, searchTerm);
            });
            
            document.getElementById('nextPage').addEventListener('click', function() {
                const activeTab = document.querySelector('.order-status-tabs .tab-btn.active');
                const status = activeTab.dataset.status;
                const searchTerm = document.getElementById('orderSearch').value;
                const currentPage = parseInt(document.querySelector('.pagination .btn-outline.active')?.textContent || 1);
                loadOrders(status, currentPage + 1, searchTerm);
            });
            
            // Print Order
            document.getElementById('printOrderBtn').addEventListener('click', function() {
                window.print();
            });
            
            // Delivery Fee Change
            document.getElementById('deliveryFee').addEventListener('change', updateOrderTotals);
            
            // Add sample data if empty
            if (getOrders().length === 0) {
                const sampleOrders = [
                    {
                        id: 'ORD-1001',
                        date: '2023-03-24T10:30:00Z',
                        status: 'pending',
                        customer: {
                            name: 'علي احمد',
                            phone: '03001234567',
                            address: 'گلشن اقبال، ڪراچي'
                        },
                        items: [
                            { id: 'prod_1', name: 'لال مرچ پائوڊر', price: 120, quantity: 2, unit: 'گرام' },
                            { id: 'prod_2', name: 'هڊو مصالحو', price: 200, quantity: 1, unit: 'گرام' }
                        ],
                        deliveryFee: 50,
                        subtotal: 440,
                        total: 490
                    },
                    {
                        id: 'ORD-1002',
                        date: '2023-03-23T14:15:00Z',
                        status: 'processing',
                        customer: {
                            name: 'فاطمه بيگم',
                            phone: '03007654321',
                            address: 'ناظم آباد، ڪراچي'
                        },
                        items: [
                            { id: 'prod_3', name: 'چڪن مرڪب', price: 150, quantity: 3, unit: 'گرام' }
                        ],
                        deliveryFee: 50,
                        subtotal: 450,
                        total: 500
                    },
                    {
                        id: 'ORD-1003',
                        date: '2023-03-22T11:45:00Z',
                        status: 'completed',
                        customer: {
                            name: 'محمد سعيد',
                            phone: '03009876543',
                            address: 'لياقت آباد، ڪراچي'
                        },
                        items: [
                            { id: 'prod_1', name: 'لال مرچ پائوڊر', price: 120, quantity: 1, unit: 'گرام' },
                            { id: 'prod_3', name: 'چڪن مرڪب', price: 150, quantity: 2, unit: 'گرام' }
                        ],
                        deliveryFee: 50,
                        subtotal: 420,
                        total: 470
                    }
                ];
                
                saveOrders(sampleOrders);
            }
            
            // Load initial orders
            loadOrders('all');
        });
        
        // Modal Functions
        function openModal(modalId) {
            document.getElementById(modalId).style.display = 'flex';
        }
        
        function closeModal() {
            document.querySelectorAll('.modal').forEach(modal => {
                modal.style.display = 'none';
            });
        }
        
        // Close modal when clicking outside
        window.addEventListener('click', function(event) {
            if (event.target.classList.contains('modal')) {
                closeModal();
            }
        });
        
        // Toggle Menu
        function toggleMenu() {
            const nav = document.getElementById('mainNav');
            nav.style.display = nav.style.display === 'flex' ? 'none' : 'flex';
        }
        
        // Toggle User Menu
        function toggleUserMenu() {
            const dropdown = document.getElementById('userDropdown');
            dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
        }
        
        // Close user dropdown when clicking outside
        document.addEventListener('click', function(event) {
            const userBtn = document.querySelector('.user-btn');
            const dropdown = document.getElementById('userDropdown');
            
            if (!userBtn.contains(event.target)) {
                dropdown.style.display = 'none';
            }
        });
        
        // Logout Function
        function logout() {
            // Here you would typically clear session data
            alert('توهان کي لاگ آئوٽ ڪيو ويو آهي');
            // Redirect to login page
            window.location.href = 'login.html';
        }
        // On login page
if (localStorage.getItem('murradMasala_loggedIn')) {
  window.location.href = 'index.html';
}
    </script>
</body>
</html>